# figure setup
library(latex2exp)
dev.new()
fig = par(
family      = "sans",
mfcol       = c(1,1),
pty         = "s",
bty         = "l",
lwd         = 1,
las         = 1,
mgp         = c(3,1,0),
xaxs        = "i",
yaxs        = "i",
font.main   = 1,
cex         = 1,
cex.main    = 1)
# density
b_hat_min  = 0.5
b_hat_max  = 3.5
b_hat_res  = 1e3
b_hat      = seq(b_hat_min, b_hat_max, len = b_hat_res)
p_beta_hat = dnorm(b_hat, beta, sqrt(sigsqr/n))
# Modellformulierung
library(MASS)                                      # Multivariate Normalverteilung
n        = 12                                      # Anzahl von Datenpunkten
p        = 1                                       # Anzahl von Betparametern
X        = matrix(rep(1,n), nrow = n)              # Designmatrix
I_n      = diag(n)                                 # n x n Einheitsmatrix
beta     = 2                                       # wahrer, aber unbekannter, Betaparameter
sigsqr   = 1                                       # wahrer, aber unbekannter, Varianzparameter
# Frequentistische Simulation
nsim     = 1e4                                     # Anzahl Realisierungen des n-dimensionalen ZVs
beta_hat = rep(NaN,nsim)                           # \hat{\beta} Realisierungsarray
for(i in 1:nsim){
y           = mvrnorm(1, X %*% beta, sigsqr*I_n) # eine Realisierung eines n-dimensionalen ZVs
beta_hat[i] = solve(t(X) %*% X) %*% t(X) %*% y   # \hat{\beta} = (X^T)X^{-1}X^T\upsilon
}
# figure setup
library(latex2exp)
dev.new()
fig = par(
family      = "sans",
mfcol       = c(1,1),
pty         = "s",
bty         = "l",
lwd         = 1,
las         = 1,
mgp         = c(3,1,0),
xaxs        = "i",
yaxs        = "i",
font.main   = 1,
cex         = 1,
cex.main    = 1)
# density
b_hat_min  = 0.5
b_hat_max  = 3.5
b_hat_res  = 1e3
b_hat      = seq(b_hat_min, b_hat_max, len = b_hat_res)
p_beta_hat = dnorm(b_hat, beta, sqrt(sigsqr/n))
# histogram
hist(
beta_hat,
breaks = 50,
col   = "gray90",
prob  = TRUE,
xlab  = TeX("$\bar{\upsilon}$"),
# figure setup
library(latex2exp)
dev.new()
fig = par(
family      = "sans",
mfcol       = c(1,1),
pty         = "s",
bty         = "l",
lwd         = 1,
las         = 1,
mgp         = c(3,1,0),
xaxs        = "i",
yaxs        = "i",
font.main   = 1,
cex         = 1,
cex.main    = 1)
# density
b_hat_min  = 0.5
b_hat_max  = 3.5
b_hat_res  = 1e3
b_hat      = seq(b_hat_min, b_hat_max, len = b_hat_res)
p_beta_hat = dnorm(b_hat, beta, sqrt(sigsqr/n))
# histogram
hist(
beta_hat,
breaks = 50,
col   = "gray90",
prob  = TRUE,
xlab  = TeX("$\\bar{\\upsilon}$"),
ylab  = "",
xlim  = c(0.5,3.5),
ylim  = c(0,1.5),
main  = "")
# density
lines(
b_hat,
p_beta_hat,
lwd   = 2,
col   = "darkorange")
# print
dev.copy2pdf(
file   = file.path(getwd(), "6_Abbildungen", "alm_6_beta_hat_1.pdf"),
width  = 5,
height = 5)
